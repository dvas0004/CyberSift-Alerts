# Malware Shellcode in Verclsid Target Process
### Description

Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro.

-------------------
### Severity

High

-------------------
### Detailed Information

Triggers on sysmon event ProcessAccess (event ID 10) where the process accessed is verclsid.exe and it is accessed with access mode 0x1FFFFF where:

  - The CallTrace field in the sysmon log entry fits the wildcard pattern '*|UNKNOWN(*VBE7.DLL*'
  OR
    - The CallTrace field in the sysmon log entry fits the wildcard pattern '*|UNKNOWN*'
     AND
    - The SourceImage field in the sysmon log entry fits the wildcard pattern '*\Microsoft Office\\*'
      (ie: the process executable from which this event originates is an MS Office applciation)
-------------------
### Possible causes of false positives

- Unknown

-------------------
### References

- https://twitter.com/JohnLaTwC/status/837743453039534080

-------------------
### Supported Log Sources

- Windows Sysmon

-------------------
